# Anonymous Types

Anonymous types like `var x = new { Test = "Cat" }` end up being types generated by the compiler. They're also used a lot in LINQ (both written by developers and generated by compilers when using the query syntax). However these types will only exist in the client assembly, the server will not understand them so we need a way of transmitting the same data structure to the server.

Our approach is to convert anonymous types to tuples. See implementation in `AnonymousTypeRewriter.cs`.

* Find any anonymous type
* Select an appropriate tuple
* Get a constructor, build an anonymous type to tuple delegate
* Visit NewExpr, ConstantExpr, LambdaExpr, MethodCallExpr, MemberExpr, ParameterExpr
* Stick on a conversion at the end back into the anonymous type (client-side)?

## Limitations
* Anonymous types with more than seven properties are not yet supported. (I need to support using the 'Rest' parameter.)
* Empty anonymous types are not yet supported. (I need to support some kind of unit type.)
* Outer result might still need to be an anonymous type as it is used in the client application.